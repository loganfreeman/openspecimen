<div class="clearfix">
  <div class="col-xs-12">
    <div class="panel panel-default">
      <div class="panel-heading">
        <span translate="cp.label_format.title">
          Label Format and Print Settings
        </span>
        <span class="os-btns" show-if-allowed="cpResource.updateOpts">
          <button class="default" ng-if="settingCtx.view != 'edit_setting'" ng-click="editLabelSettings()">
            <span class="fa fa-pencil"></span>
            <span translate="common.buttons.edit">Edit</span>
          </button>
        </span>
      </div>
      <div class="panel-body">
        <form name="lsForm" os-form-validator="lsForm" class="form-horizontal" novalidate>
          <div ng-if="settingCtx.view == 'edit_setting'">
            <div class="form-group">
              <label class="control-label col-xs-3">
                <span translate="cp.label_format.ppid">PPID Format</span>
              </label>
              <div class="col-xs-6">
                <input type="text" ng-model="settingCtx.cp.ppidFmt" class="form-control" placeholder="{{'cp.ppid_fmt' | translate}}">
              </div>
            </div>
            
            <div class="form-group">
              <label class="control-label col-xs-3">
                <span translate="cp.label_format.visit">Visit</span>
              </label>
              <div class="col-xs-6">
                <input type="text" ng-model="settingCtx.cp.visitNameFmt" class="form-control" 
                  placeholder="{{'cp.visit_name_fmt' | translate}}">
              </div>
            </div>
            
            <div class="form-group">
              <label class="control-label col-xs-3">
                <span translate="cp.label_format.specimen">Specimen</span>
              </label>
              <div class="col-xs-6">
                <input type="text" ng-model="settingCtx.cp.specimenLabelFmt" class="form-control" 
                  placeholder="{{'cp.specimen_label_fmt' | translate}}">
              </div>
            </div>
            
            <div class="form-group">
              <label class="control-label col-xs-3">
                <span translate="cp.label_format.aliquot">Aliquot</span>
              </label>
              <div class="col-xs-6">
                <input type="text" ng-model="settingCtx.cp.aliquotLabelFmt" class="form-control" 
                  placeholder="{{'cp.aliquot_label_fmt' | translate}}">
              </div>
            </div>
            
            <div class="form-group">
              <label class="control-label col-xs-3">
                <span translate="cp.label_format.derivative">Derivative</span>
              </label>
              <div class="col-xs-6">
                <input type="text" ng-model="settingCtx.cp.derivativeLabelFmt" class="form-control" 
                  placeholder="{{'cp.derivative_label_fmt' | translate}}">
              </div>
            </div>
            
            <div class="form-group">
              <label class="control-label col-xs-3">
                <span translate="cp.label_format.manual">User Inputs Allowed for</span>
              </label>
              <div class="col-xs-9">
                <label class="checkbox-inline">
                  <input type="checkbox" ng-model="settingCtx.cp.manualPpidEnabled"> 
                  <span translate="cp.ppids">Participant Protocol IDs</span>
                </label>
                <label class="checkbox-inline">
                 <input type="checkbox" ng-model="settingCtx.cp.manualVisitNameEnabled"> 
                 <span translate="cp.visit_names">Visit Names</span>
                </label>
                <label class="checkbox-inline">
                  <input type="checkbox" ng-model="settingCtx.cp.manualSpecLabelEnabled"> 
                  <span translate="cp.spec_labels">Specimen Labels</span>
                </label>
              </div>
            </div>
            
            <div class="form-group">
              <label class="control-label col-xs-3">
                <span translate="cp.pre_print_spmn_labels">Pre Print Specimen Labels</span>
              </label>
              <div class="col-xs-6">
                <label class="radio-inline" ng-repeat="spmnLabelPrePrintMode in spmnLabelPrePrintModes">
                  <input type="radio" name="spmnLblPrePrintMode" ng-model="settingCtx.cp.spmnLabelPrePrintMode"
                    ng-value="spmnLabelPrePrintMode.name" ng-change="onPrePrintModeChange()">
                  <span>{{spmnLabelPrePrintMode.displayName}}</span>
                </label>
                <div os-field-warn="'cp.disable_pre_print_warning'" ng-if="prePrintDisabled"></div>
              </div>
            </div>
            
            <div class="form-group">
              <label class="col-xs-3 control-label" translate="cp.print_settings">Print Settings</label>
              <div class="col-xs-3">
                <label class="control-label">
                  <span translate="cp.when_to_print">When To Print</span>
                </label>
              </div>
              <div class="col-xs-3">
                <label class="control-label">
                  <span translate="cp.copies">Copies</span>
                </label>
              </div>
            </div>

            <div class="form-group clearfix" ng-form="psForm" ng-repeat="setting in settingCtx.cp.spmnLabelPrintSettings">
              <label class="col-xs-3 control-label">
                {{'cp.spmn_lineages.' + setting.lineage | translate}}
              </label>
              <div class="col-xs-3">
                <os-select ng-model="setting.printMode" list="spmnLabelAutoPrintModes" display-prop="displayName">
                </os-select>
              </div>
              <div class="col-xs-3">
                <input name="copies" ng-model="setting.copies" class="form-control" type="text" ng-pattern="/^[0-9]+$/">
                <div os-field-error field="psForm.copies"></div>
              </div>
            </div>
          </div>
          
          <div ng-if="settingCtx.view != 'edit_setting'">
            <div class="os-section os-line-section col-xs-8">
              <ul class="os-key-values os-one-col">
                <li class="item">
                  <span class="key key-sm" translate="cp.label_format.ppid">PPID Format</span>
                  <span class="value value-md">{{settingCtx.cp.ppidFmt | osNoValue}}</span>
                </li>

                <li class="item">
                  <span class="key key-sm" translate="cp.label_format.visit">Visit</span>
                  <span class="value value-md">{{settingCtx.cp.visitNameFmt | osNoValue}}</span>
                </li>
          
                <li class="item">
                  <span class="key key-sm" translate="cp.label_format.specimen">Specimen</span>
                  <span class="value value-md">{{settingCtx.cp.specimenLabelFmt | osNoValue}}</span>
                </li>
          
                <li class="item">
                  <span class="key key-sm" translate="cp.label_format.aliquot">Aliquot</span>
                  <span class="value value-md">{{settingCtx.cp.aliquotLabelFmt | osNoValue}}</span>
                </li>
          
                <li class="item">
                  <span class="key key-sm" translate="cp.label_format.derivative">Derivative</span>
                  <span class="value value-md">{{settingCtx.cp.derivativeLabelFmt | osNoValue}}</span>
                </li>
          
                <li class="item">
                  <span class="key key-sm" translate="cp.label_format.manual">User Inputs Allowed for</span>
                  <span class="value value-md">{{userInputLabels | osNoValue}}</span>
                </li>
          
                <li class="item">
                  <span class="key key-sm" translate="cp.pre_print_spmn_labels">Pre Print Specimen Labels</span>
                  <span class="value value-md">
                    {{'cp.spmn_label_pre_print_modes.' + settingCtx.cp.spmnLabelPrePrintMode | translate}}
                  </span>
                </li>
              </ul>
            </div>
            
            <div class="os-section os-line-section col-xs-8">
              <strong class="key key-sm" translate="cp.print_settings">Print Settings</strong>
              <span ng-if="settingCtx.cp.spmnLabelPrintSettings.length == 0" translate="common.none">None</span>
              <table class="os-table os-table-muted-hdr os-border" ng-if="settingCtx.cp.spmnLabelPrintSettings.length > 0">
                <thead class="os-table-head">
                  <tr class="row">
                    <td class="col os-col-40">
                      <span translate="cp.lineage">Lineage</span>
                    </td>
                    <td class="col os-col-30">
                      <span translate="cp.when_to_print">When to Print</span>
                    </td>
                    <td class="col os-col-30">
                      <span translate="cp.copies">Copies</span>
                    </td>
                  </tr>
                <thead>
                <tbody class="os-table-body">
                  <tr class="row" ng-form="psForm" ng-repeat="setting in settingCtx.cp.spmnLabelPrintSettings">
                    <td class="col">
                      <span>{{'cp.spmn_lineages.' + setting.lineage | translate}}</span>
                    </td>
                    <td class="col" ng-switch on="!!setting.printMode">
                      <span ng-switch-when="true">
                        {{'srs.spmn_label_auto_print_modes.' + setting.printMode | translate}}
                      </span>
                      <span ng-switch-default translate="common.not_specified">
                        Not Specified
                      </span>
                    </td>
                    <td class="col">
                      <span>{{setting.copies | osNoValue}}</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          
          <div class="form-group" ng-if="settingCtx.view == 'edit_setting'">
            <div class="col-xs-offset-3 col-xs-6">
              <button class="btn btn-primary" os-form-submit="saveSettings()">
                <span translate="common.buttons.save">Save</span>
              </button>
              <button class="btn os-btn-text" ng-click="revertEdit()">
                <span translate="common.buttons.cancel">Cancel</span>
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
